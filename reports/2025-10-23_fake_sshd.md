---
tags: [malware-analysis, linux, cowrie, fake-sshd, go, pam, honeypot, tpot]
---

# Incident Summary: Fake SSHD Malware (Go/PAM Variant)

> **TL;DR:** Malicious Go-based fake SSHD binary leveraging PAM hooks for credential theft and remote backdoor access.  
> Detected by 44/65 engines on VirusTotal — confirmed Linux backdoor (FakeSSHD / Go PAM variant).

**Incident Date:** October 23 2025 <br>
**Honeypot:** T-Pot CE (Cowrie container on AWS EC2)
**Analyst:** Cole Jamieson
**Classification:** Confirmed Linux Backdoor (Fake SSHD / Go PAM variant)

## Overview
During routine monitoring of the Cowrie SSH honeypot, an attacker uploaded a file named sshd into a hidden directory and attempted to execute it with multiple external IPs as arguments.

### Attacker Command
nohup ./.32127324422402301/sshd 196.188.187.153 103.145.145.82 124.225.88.88 ... &

## File Details
| Attribute | Value |
|-----------|-------|
| **Filename** | `sshd` |
| **Stored Path** | `/data/cowrie/downloads/94f2e4d8d4436874785cd14e6e6d403507b8750852f7f2040352069a75da4c00` |
| **SHA-256** | `94f2e4d8d4436874785cd14e6e6d403507b8750852f7f2040352069a75da4c00` |
| **File Size** | `30,304,472 bytes` (≈ 30 MB) |
| **File Type** | `ELF 64-bit LSB executable, dynamically linked, stripped` |
| **Language / Build Type** | `Go (cgo)` |
| **Linked Libraries** | `libpam.so.0`, `libpthread.so.0`, `libc.so.6` |
| **VirusTotal Detection** | `44 / 65 engines → malicious` |
| **Likely Family** | `FakeSSHD / GoBot / Kaiji derivative` |
| **Purpose** | `Credential theft • Remote backdoor • C2 connectivity` |

## Statistic Analysis Highlights:
- **Language / Build:** Identified as a **Go** binary (presence of sections `.gopclntab`, `.go.buildinfo`, `.typelink`, `.itablink`).
- **PAM integration (cgo):** Dynamic symbols show many PAM functions (`pam_start`, `pam_authenticate`, `pam_open_session`, `pam_close_session`, `pam_setcred`, `pam_getenv`, `pam_chauthtok`, `pam_strerror`) indicating the binary interacts with the PAM stack — consistent with a fake `sshd` that intercepts or validates credentials.
- **Concurrency / Threads:** Binary links `libpthread` and references to `pthread_create`, `pthread_detach`, and thread-start helper names in the symbol table, indicating threaded behavior.
- **Stripped:** The binary is stripped (no original debug symbols), increasing analysis difficulty and indicating deliberate obfuscation.
- **Entry point:** `0x403470` (from ELF header).
- **Notable linked libs:** `libpam.so.0`, `libpthread.so.0`, `libc.so.6`.
- **Large read-only data:** Extremely large `.rodata` and Go runtime sections (`.gopclntab`, `.noptrdata`, `.gopclntab`), common for Go binaries with embedded strings/resources.
- **Suspicious strings (examples):** binary contains embedded IPv4 addresses and network-related strings (extracted separately into `extracted_ips.txt`) — consistent with C2 bootstrap or target lists.
- **Conclusion from static traces:** The binary is a Go-compiled fake `sshd`/backdoor that uses PAM hooks and threads, appears intentionally stripped and obfuscated, and contains embedded network IOCs → consistent with credential-capturing/backdoor botnet agents.
— Paste-ready: Blank Static Analysis Template (for future samples)

## Indicators of Compromise (IOCs)
```
# SHA256
94f2e4d8d4436874785cd14e6e6d403507b8750852f7f2040352069a75da4c00

# File paths
/data/cowrie/downloads/94f2e4d8d4436874785cd14e6e6d403507b8750852f7f2040352069a75da4c00
./.32127324422402301/sshd


# Extracted IPs
196.188.187.153
103.145.145.82
124.225.88.88
188.166.211.175
50.6.7.7
103.210.21.242
93.127.183.175
220.181.172.244
111.48.105.22
103.145.145.79
8.211.165.95
36.97.228.213
51.158.252.114
125.88.174.215
37.58.22.112
182.180.103.209
221.179.57.254
79.120.74.12
121.18.43.102
106.75.132.223
64.225.109.250
146.190.175.84
179.189.229.2
157.255.155.179
160.176.203.9
186.13.21.145
52.91.199.247
115.231.181.61
221.14.147.153
139.59.253.66
123.57.140.9
138.197.163.192
156.229.233.208
103.146.202.22
60.205.152.248
210.5.27.154
58.49.140.148
116.128.243.59
103.142.87.15
43.163.220.159
103.145.145.78
77.237.233.221
39.96.195.41
47.93.137.235
125.124.106.113
173.249.63.116
43.224.248.178
118.26.39.178
196.57.217.2
152.32.133.47
103.113.81.66
```
*Analysis compete - confirmed malicious ELF (Go/PAM FakeSSHD). Sample retained offline for further reverse engineering.*
